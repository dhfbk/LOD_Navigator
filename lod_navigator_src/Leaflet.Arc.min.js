if (!L) {
    throw "Leaflet.js not included";
} else if (!arc && !arc.GreatCircle) {
    throw "arc.js not included";
} else {
    L.Polyline.Arc = function (from, to, options) {
        from = L.latLng(from);
        to = L.latLng(to);

        var vertices = 400;
        var arcOptions = {offset: 300};

        var generator = new arc.GreatCircle(
            {x: from.lng, y: from.lat},
            {x: to.lng, y: to.lat}
        );


        var line = generator.Arc(vertices, arcOptions);


        var geojson = line.json();


        var latLngs = [];


        var arraysOfLines = [];


        for (var i = 0 ;i < line.geometries.length; i++){
            var linea = line.geometries[i];

            linea.coords.forEach(function (point) {
                latLngs.push(L.latLng(
                    [point[1], point[0]]
                ));
            });
            arraysOfLines.push(L.polyline(latLngs, options));
            latLngs = [];
        }

        
       // line.geometries[0].coords

       /*
            line.geometries.forEach(function (line) {
                line.coords.forEach(function (point) {
                    latLngs.push(L.latLng(
                        [point[1], point[0]]
                    ));
                });

            });
            line.geometries[0].coords
        */

        var objs = {
            geojson: L.geoJson(geojson, options),
            geometry: arraysOfLines
        }

        //return L.polyline(latLngs, options);
        return objs;
    };
}